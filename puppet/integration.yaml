classes:
  - nsidc_miniconda
  - nginx

nginx::nginx_upstreams:
  'icebridge-services':
    ensure: present
    members:
      - localhost:5000

nginx::nginx_vhosts:
  'icebridge':
    www_root: '/opt/icebridge-services'
  'localhost':
    www_root: '/usr/share/nginx/html'
    ensure: absent

nginx::nginx_locations:
  '/services':
    vhost: 'icebridge'
    location: '/services'
    proxy: 'http://icebridge-services'

nsidc_miniconda::install:
  /opt/miniconda:
    version: '3.9.1'
    build: true
    config:
      channels:
        binstar_main: true
        binstar_dev: true
    packages:
      - gunicorn
